import{r as d,j as o,L as B,a as f,h as x}from"./index-3ed1fa78.js";import{u as G,H as K,D as P,C as L,a as V}from"./HeaderData-f8341142.js";import{B as J}from"./Box-2f3a3966.js";import{E as Q}from"./EditIcon-72ee5f20.js";import{D as W}from"./DeleteIcon-e6cc714b.js";import{u as X}from"./useZones-34f93c9a.js";import{C as Y,F as _}from"./FormActionBtns-c23092d4.js";import{C as ee}from"./CustomInput-6ca7ad9c.js";import{u as re}from"./FormError-a3fab181.js";import{R as ae}from"./RequestError-ce21148f.js";import{v as oe}from"./form-3a2308eb.js";import{E as te}from"./EmptyData-5a33961e.js";import{B as se}from"./BoxContainerPage-d81583a3.js";import"./useQuery-6083f14c.js";const Ce=()=>{var M;const[z,i]=d.useState(!1),[E,p]=d.useState(!1),[h,b]=d.useState({}),[C,w]=d.useState(!1),[k,l]=d.useState(!1),n=d.useRef(),{data:e,isError:F,isLoading:j,error:H,isFetching:I,refetch:ne}=X(),{name:T,values:m,handleInputChange:v,reset:g}=re({name:""}),{showAndHideModal:t}=G(),Z=r=>{v(r.name,"name"),n.current=r,i(!0),w(!0)},O=r=>{p(!E),n.current=r},R=async r=>{var c;l(!0);try{const s=await x.delete("/zones/"+r);s.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.filter(u=>u.id!==r)),p(!1),t("Borrado",s.data.message)):t("Error",s.data.message||"Algo malo ocurrío.","red")}catch(s){s.response&&t("Error",((c=s.response.data)==null?void 0:c.message)||"Algo malo ocurrío.","red")}finally{l(!1)}},$=async r=>{var u,S,N;r.preventDefault();const{error:c,ok:s}=oe(m);if(b(c),!s)return!1;if(C)try{l(!0);const a=await x.put(`/zones/${(u=n.current)==null?void 0:u.id}`,m);a.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.map(y=>{var D;return y.id===((D=n.current)==null?void 0:D.id)&&(y.name=m.name),y})),g(),i(!1),t("Editado",a.data.message)):t("Error",a.data.message||"Algo malo ocurrío.","red")}catch(a){a.response&&t("Error",((S=a.response.data)==null?void 0:S.message)||"Algo malo ocurrío.","red")}finally{l(!1)}else try{l(!0);const a=await x.post("/zones",m);a.data.ok?(e==null||e.data.unshift(a.data.data),g(),i(!1),t("Guardado",a.data.message)):t("Error",a.data.message||"Algo malo ocurrío.","red")}catch(a){a.response&&t("Error",((N=a.response.data)==null?void 0:N.message)||"Algo malo ocurrío.","red")}finally{l(!1)}},A=()=>{g(),i(!1),b({})},q=()=>{w(!1),n.current=null,i(!0)},U=r=>f("div",{className:"flex gap-x-3 items-center justify-center",children:[o(Q,{action:()=>Z(r)}),o(W,{action:()=>O(r)})]});return j?o(B,{}):F?o(ae,{error:H}):f(se,{children:[o(K,{action:q,text:"Zonas"}),e.data.length>0?o(J,{className:"!p-0 !overflow-hidden !border-none  sm:mx-0  sm:w-[500px] mb-4 ",children:f(P,{size:"small",emptyMessage:"Aún no hay zona",className:"!overflow-hidden   !border-none",value:e==null?void 0:e.data,dataKey:"id",responsiveLayout:"scroll",children:[o(L,{field:"name",header:"Nombre",headerClassName:"!border-none dark:!bg-gray-800 dark:!text-slate-400",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 "}),o(L,{body:U,headerClassName:"!border-none dark:!bg-gray-800",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600",exportable:!1,style:{width:90}})]})}):o(te,{text:"Aún no hay zona"}),I&&o(B,{h:40,w:40}),o(V,{show:E,savingOrUpdating:k,setShow:p,destroy:()=>{var r;return R((r=n.current)==null?void 0:r.id)},text:`La zona ${(M=n.current)==null?void 0:M.name}`}),o(Y,{show:z,closeModal:A,overlayClick:!1,className:"max-w-[500px]  sm:w-[380px]",titleText:`${C?"Editar":"Crear"} zona`,children:f("form",{onSubmit:$,children:[o(ee,{placeholder:"Sur,Este,Norte",initialValue:T,onChange:r=>v(r,"name"),maxLength:50,label:"Nombre",required:!0,minLength:1,hasError:h==null?void 0:h.name,errorText:"El nombre es obligatorio."}),o(_,{savingOrUpdating:k,onClose:A})]})})]})};export{Ce as default};
