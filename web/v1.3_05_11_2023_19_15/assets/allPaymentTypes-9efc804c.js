import{r as d,j as t,L as T,a as u,h as x}from"./index-3ed1fa78.js";import{u as K,H as V,D as J,C as B,a as Q}from"./HeaderData-f8341142.js";import{B as W}from"./Box-2f3a3966.js";import{E as X}from"./EditIcon-72ee5f20.js";import{D as Y}from"./DeleteIcon-e6cc714b.js";import{C as Z,F as _}from"./FormActionBtns-c23092d4.js";import{C as z}from"./CustomInput-6ca7ad9c.js";import{u as ee}from"./FormError-a3fab181.js";import{R as ae}from"./RequestError-ce21148f.js";import{u as re}from"./usePaymentTypes-eca79a45.js";import{v as te}from"./form-3a2308eb.js";import{E as oe}from"./EmptyData-5a33961e.js";import{B as se}from"./BoxContainerPage-d81583a3.js";import"./useQuery-6083f14c.js";const Ce=()=>{var M;const[L,i]=d.useState(!1),[b,f]=d.useState(!1),[g,E]=d.useState(),[C,w]=d.useState(!1),[k,l]=d.useState(!1),{name:F,values:m,handleInputChange:v,reset:h}=ee({name:""}),n=d.useRef(),{data:e,isError:j,isLoading:H,error:I,isFetching:P,refetch:ne}=re(),{showAndHideModal:o}=K(),O=a=>{v(a.name,"name"),i(!0),w(!0),n.current=a},R=a=>{f(!b),n.current=a},$=async a=>{var p,S,N;a.preventDefault();const{error:c,ok:s}=te(m);if(E(c),!s)return!1;if(C)try{l(!0);const r=await x.put(`/paymenttypes/${(p=n.current)==null?void 0:p.id}`,m);r.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.map(y=>{var D;return y.id===((D=n.current)==null?void 0:D.id)&&(y.name=m.name),y})),h(),i(!1),o("Editado",r.data.message)):o("Error",r.data.message||"Algo malo ocurrío.","red")}catch(r){r.response&&o("Error",((S=r.response.data)==null?void 0:S.message)||"Algo malo ocurrío.","red")}finally{l(!1)}else try{l(!0);const r=await x.post("/paymenttypes",m);r.data.ok?(e==null||e.data.unshift(r.data.data),h(),i(!1),o("Guardado",r.data.message)):o("Error",r.data.message||"Algo malo ocurrío.","red")}catch(r){r.response&&o("Error",((N=r.response.data)==null?void 0:N.message)||"Algo malo ocurrío.","red")}finally{l(!1)}},q=async a=>{var c;try{l(!0);const s=await x.delete("/paymenttypes/"+a);s.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.filter(p=>p.id!==a)),f(!1),o("Borrado",s.data.message)):o("Error",s.data.message||"Algo malo ocurrío.","red")}catch(s){s.response&&o("Error",((c=s.response.data)==null?void 0:c.message)||"Algo malo ocurrío.","red")}finally{l(!1)}},A=()=>{h(),i(!1),E({})},U=a=>u("div",{className:"flex gap-x-3 items-center justify-center",children:[t(X,{action:()=>O(a)}),t(Y,{action:()=>R(a)})]}),G=()=>{i(!0),w(!1),n.current=null};return H?t(T,{}):j?t(ae,{error:I}):u(se,{children:[t(V,{action:G,text:"Tipos de pagos"}),e.data.length>0?t(W,{className:"!p-0 !overflow-hidden !border-none sm:mx-0   sm:w-[500px] mb-4 ",children:u(J,{size:"small",emptyMessage:"Aún no hay tipos de pago",className:"!overflow-hidden   !border-none",value:e==null?void 0:e.data,dataKey:"id",responsiveLayout:"scroll",children:[t(B,{field:"name",header:"Nombre",headerClassName:"!border-none dark:!bg-gray-800 dark:!text-slate-400",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 "}),t(B,{body:U,headerClassName:"!border-none dark:!bg-gray-800",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 ",exportable:!1,style:{width:90}})]})}):t(oe,{text:"Aún no hay tipo de pago."}),P&&t(T,{h:40,w:40}),t(Q,{show:b,savingOrUpdating:k,setShow:f,destroy:()=>{var a;return q((a=n.current)==null?void 0:a.id)},text:`${(M=n.current)==null?void 0:M.name}`}),t(Z,{show:L,closeModal:A,className:"max-w-[400px]  sm:w-[400px] w-fit",titleText:`${C?"Editar":"Crear"} tipo de pago `,children:u("form",{onSubmit:$,children:[t(z,{placeholder:"Débito,Crédito,Efectivo",initialValue:F,onChange:a=>v(a,"name"),maxLength:80,label:"Nombre",required:!0,minLength:1,hasError:g==null?void 0:g.name,errorText:"El nombre es obligatorio."}),t(_,{savingOrUpdating:k,onClose:A})]})})]})};export{Ce as default};
