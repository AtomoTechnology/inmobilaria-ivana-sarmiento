import{h as p,r as d,j as r,L as D,a as x}from"./index-3ed1fa78.js";import{u as P,H as J,D as W,C as b,a as X}from"./HeaderData-f8341142.js";import{B as Y}from"./Box-2f3a3966.js";import{E as Z}from"./EditIcon-72ee5f20.js";import{C as _,F as z}from"./FormActionBtns-c23092d4.js";import{C as F}from"./CustomInput-6ca7ad9c.js";import{u as ee}from"./FormError-a3fab181.js";import{R as ae}from"./RequestError-ce21148f.js";import{u as re}from"./useQuery-6083f14c.js";import{v as oe}from"./form-3a2308eb.js";import{E as te}from"./EmptyData-5a33961e.js";import{B as se}from"./BoxContainerPage-d81583a3.js";const le=async()=>await p.get("/config?sort=key").then(m=>m.data),ne=()=>re({queryKey:["configs"],queryFn:le}),ve=()=>{var N;const[m,c]=d.useState(!1),[q,v]=d.useState(!1),[l,C]=d.useState(),[y,E]=d.useState(!1),n=d.useRef(),[w,i]=d.useState(!1),{key:T,value:j,values:u,handleInputChange:A,reset:k,updateAll:H}=ee({key:"",value:""}),{showAndHideModal:t}=P(),{data:e,isError:I,isLoading:V,error:O,isFetching:Q,refetch:ie}=ne(),R=a=>{H({key:a.key,value:a.value}),c(!0),E(!0),n.current=a},$=async a=>{var f;try{i(!0);const s=await p.delete("/config/"+a);s.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.filter(g=>g.id!==a)),v(!1),t("Borrado",s.data.message)):t("Error",s.data.message||"Algo malo ocurrío.","red")}catch(s){s.response&&t("Error",((f=s.response.data)==null?void 0:f.message)||"Algo malo ocurrío.","red")}finally{i(!1)}},G=async a=>{var g,S,B;a.preventDefault();const{error:f,ok:s}=oe(u);if(C(f),!s)return!1;if(y)try{i(!0);const o=await p.put(`/config/${(g=n.current)==null?void 0:g.id}`,u);o.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.map(h=>{var L;return h.id===((L=n.current)==null?void 0:L.id)&&(h.key=u.key,h.value=u.value),h})),k(),c(!1),t("Editado",o.data.message)):t("Error",o.data.message||"Algo malo ocurrío.","red")}catch(o){o.response&&t("Error",((S=o.response.data)==null?void 0:S.message)||"Algo malo ocurrío.","red")}finally{i(!1)}else try{i(!0);const o=await p.post("/config",u);o.data.ok?(e==null||e.data.unshift(o.data.data),k(),c(!1),t("Guardado",o.data.message)):t("Error",o.data.message||"Algo malo ocurrío.","red")}catch(o){o.response&&t("Error",((B=o.response.data)==null?void 0:B.message)||"Algo malo ocurrío.","red")}finally{i(!1)}},M=()=>{k(),c(!1),C({})},K=a=>r("div",{className:"flex gap-x-3 items-center justify-center",children:r(Z,{action:()=>R(a)})}),U=()=>{c(!0),E(!1),n.current=null};return V?r(D,{}):I?r(ae,{error:O}):x(se,{children:[r(J,{action:U,text:"Info general"}),e.data.length>0?r(Y,{className:"!p-0 !overflow-hidden !border-none sm:mx-0   sm:w-[500px] mb-4 ",children:x(W,{size:"small",emptyMessage:"Aún no hay infos general",className:"!overflow-hidden   !border-none",value:e==null?void 0:e.data,dataKey:"id",responsiveLayout:"scroll",children:[r(b,{field:"key",header:"Nombre",headerClassName:"!border-none dark:!bg-gray-800 dark:!text-slate-400",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 "}),r(b,{field:"value",header:"Valor",headerClassName:"!border-none dark:!bg-gray-800 dark:!text-slate-400",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 "}),r(b,{body:K,headerClassName:"!border-none dark:!bg-gray-800",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 ",exportable:!1,style:{width:90}})]})}):r(te,{text:"Aún no hay infos general "}),Q&&r(D,{h:40,w:40}),r(X,{show:q,savingOrUpdating:w,setShow:v,destroy:()=>{var a;return $((a=n.current)==null?void 0:a.id)},text:`${(N=n.current)==null?void 0:N.key}`}),r(_,{show:m,closeModal:M,overlayClick:!1,className:"max-w-[400px] sm:w-[370px] w-[fit]",titleText:`${y?"Editar":"Crear"}  info general`,children:x("form",{onSubmit:G,children:[r(F,{placeholder:"Email,teléfono,etc",initialValue:T,disabled:y,onChange:a=>A(a,"key"),maxLength:50,label:"Clave",required:!0,hasError:l==null?void 0:l.key,errorText:"La clave es obligatoria."}),r(F,{placeholder:"example@gmail.com",initialValue:j,onChange:a=>A(a,"value"),maxLength:255,label:"Valor",required:!0,hasError:l==null?void 0:l.value,errorText:"El valor es obligatorio."}),r(z,{savingOrUpdating:w,onClose:M})]})})]})};export{ve as default};
