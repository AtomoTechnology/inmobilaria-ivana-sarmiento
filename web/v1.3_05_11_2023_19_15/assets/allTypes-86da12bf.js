import{r as n,j as t,L as N,a as u,h as x}from"./index-3ed1fa78.js";import{u as K,H as V,D as J,C as B,a as Q}from"./HeaderData-f8341142.js";import{B as W}from"./Box-2f3a3966.js";import{E as X}from"./EditIcon-72ee5f20.js";import{D as Y}from"./DeleteIcon-e6cc714b.js";import{C as Z,F as _}from"./FormActionBtns-c23092d4.js";import{u as z}from"./FormError-a3fab181.js";import{R as ee}from"./RequestError-ce21148f.js";import{u as re}from"./usePropertyTypes-e0a794cf.js";import{v as ae}from"./form-3a2308eb.js";import{E as te}from"./EmptyData-5a33961e.js";import{C as oe}from"./CustomTextArea-ed7f84a9.js";import{B as se}from"./BoxContainerPage-d81583a3.js";import"./useQuery-6083f14c.js";const be=()=>{var M;const[L,l]=n.useState(!1),[C,f]=n.useState(!1),[h,E]=n.useState({}),[b,w]=n.useState(!1),i=n.useRef(),[k,d]=n.useState(!1),{description:F,values:c,handleInputChange:A,reset:g}=z({description:""}),{data:e,isError:j,isLoading:H,error:P,isFetching:I,refetch:ie}=re(),{showAndHideModal:o}=K(),O=r=>{A(r.description,"description"),l(!0),w(!0),i.current=r},R=r=>{f(!C),i.current=r},$=async r=>{var p;try{d(!0);const s=await x.delete("/propertytypes/"+r);s.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.filter(m=>m.id!==r)),f(!1),o("Borrado",s.data.message)):o("Error",s.data.message||"Algo malo ocurrío.","red")}catch(s){s.response&&o("Error",((p=s.response.data)==null?void 0:p.message)||"Algo malo ocurrío.","red")}finally{d(!1)}},q=async r=>{var m,D,S;r.preventDefault();const{error:p,ok:s}=ae(c);if(E(p),!s)return!1;if(b)try{d(!0);const a=await x.put(`/propertytypes/${(m=i.current)==null?void 0:m.id}`,c);a.data.ok?(e!=null&&e.data&&(e.data=e==null?void 0:e.data.map(y=>{var T;return y.id===((T=i.current)==null?void 0:T.id)&&(y.description=c.description),y})),g(),l(!1),o("Editado",a.data.message)):o("Error",a.data.message||"Algo malo ocurrío.","red")}catch(a){a.response&&o("Error",((D=a.response.data)==null?void 0:D.message)||"Algo malo ocurrío.","red")}finally{d(!1)}else try{d(!0);const a=await x.post("/propertytypes",c);a.data.ok?(e==null||e.data.unshift(a.data.data),g(),l(!1),o("Guardado",a.data.message)):o("Error",a.data.message||"Algo malo ocurrío.","red")}catch(a){a.response&&o("Error",((S=a.response.data)==null?void 0:S.message)||"Algo malo ocurrío.","red")}finally{d(!1)}},v=()=>{g(),l(!1),E({})},U=r=>u("div",{className:"flex gap-x-3 items-center justify-center",children:[t(X,{action:()=>O(r)}),t(Y,{action:()=>R(r)})]}),G=()=>{l(!0),w(!1),i.current=null};return H?t(N,{}):j?t(ee,{error:P}):u(se,{children:[t(V,{action:G,text:"Tipos de propiedades"}),e.data.length>0?t(W,{className:"!p-0 !overflow-hidden !border-none  sm:mx-0  sm:w-[500px] mb-4 ",children:u(J,{size:"small",emptyMessage:"Aún no hay tipo de propiedad",className:"!overflow-hidden !border-none",value:e==null?void 0:e.data,dataKey:"id",responsiveLayout:"scroll",children:[t(B,{field:"description",header:"Descripción",headerClassName:"!border-none dark:!bg-gray-800 dark:!text-slate-400",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 "}),t(B,{body:U,headerClassName:"!border-none dark:!bg-gray-800",className:"dark:bg-slate-700 dark:text-slate-400 dark:!border-slate-600 ",exportable:!1,style:{width:90}})]})}):t(te,{text:"Aún no hay tipo de propiedad"}),I&&t(N,{h:40,w:40}),t(Q,{show:C,savingOrUpdating:k,setShow:f,destroy:()=>{var r;return $((r=i.current)==null?void 0:r.id)},text:`${(M=i.current)==null?void 0:M.description}`}),t(Z,{show:L,closeModal:v,className:"max-w-[500px] sm:w-[480px] ",titleText:`${b?"Editar":"Crear"} tipo de propiedad`,children:u("form",{onSubmit:q,children:[t(oe,{placeholder:"Casa 2 dormitorios,Depto",initialValue:F,onChange:r=>A(r,"description"),maxLength:255,label:"Descripción",required:!0,minLength:1,hasError:h==null?void 0:h.description,errorText:"La descripción es obligatoria."}),t(_,{savingOrUpdating:k,onClose:v})]})})]})};export{be as default};
